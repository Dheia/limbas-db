<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;BETA&nbsp;VERSION:&nbsp;Class&nbsp;names,&nbsp;constructor&nbsp;arguments&nbsp;as&nbsp;well&nbsp;as&nbsp;public&nbsp;method<br />&nbsp;*&nbsp;names&nbsp;are&nbsp;subject&nbsp;to&nbsp;change!&nbsp;*/<br />&nbsp;<br /></span><span style="color: #0000BB">define</span><span style="color: #007700">(</span><span style="color: #DD0000">'PATHSEP'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'/'</span><span style="color: #007700">);<br /><br />require_once(</span><span style="color: #DD0000">"olTemplate.class.php"</span><span style="color: #007700">);<br />require_once(</span><span style="color: #DD0000">"olODFContainer.class.php"</span><span style="color: #007700">);<br />require_once(</span><span style="color: #DD0000">"olODFPicture.class.php"</span><span style="color: #007700">);<br />require_once(</span><span style="color: #DD0000">"olODFTemplate.class.php"</span><span style="color: #007700">);<br />require_once(</span><span style="color: #DD0000">"olXMLParser.class.php"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$container&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">olODFContainer</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$template&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">olODFTemplate</span><span style="color: #007700">(</span><span style="color: #0000BB">$container</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$parser&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">olXMLParser</span><span style="color: #007700">(</span><span style="color: #DD0000">"preliminary.xml"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$template</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;fill&nbsp;the&nbsp;ODT&nbsp;file&nbsp;with&nbsp;XML&nbsp;data.&nbsp;*/<br /></span><span style="color: #0000BB">$parser</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">parse</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">/*&nbsp;update&nbsp;document&nbsp;content&nbsp;and&nbsp;download&nbsp;document.&nbsp;*/<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$template</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">()){<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">$container</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">download</span><span style="color: #007700">())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"ERROR:&nbsp;failed&nbsp;downloading&nbsp;{$container-&gt;name}"</span><span style="color: #007700">;<br />}&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"ERROR:&nbsp;failed&nbsp;updating&nbsp;content!&nbsp;(no&nbsp;write&nbsp;permissions&nbsp;for&nbsp;"</span><span style="color: #007700">.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"{$container-&gt;tempdir}&nbsp;folder?)"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code>